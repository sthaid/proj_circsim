====================  NEXT  =================================================

optimize model computations
  - and check with profiling   DONE
  - if there are performance issues use profiling;
  - optimization, and multi threads, change O0 to O2
  - factor common operations

clear all is not clearing scope select
- use a param

work the xxx issues in *.c

documentation
- readme.md and design files
- add copyright notices

lc1 test should test with a power source or some better method than
precharging;  I saw this on website, find that again

start taking notes for fusor power supply, and check those in too

glitch in the graph of test/rl1   PROBABLY DONE
try min max history changes with test/rc7
problem with history graphs when the graph span is short in comparison to delta_t

regression test    PROBABLY-DONE
- all
- problems

some circuits are too slow or don't converge   PROBABLY-DONE
- try auto_delta_t x.001 instead of x.0001
- examine conditions under which it doesn;t stabilize
  and adjust the stability limits
- update test/README when problems are fixed
- check for model stabilized, how to support the small currents such as in test rc7?
- test rc7 using only resistors should converge quickly
- test rc7 converge with 1mf cap 
- IDEA - if model is slow to converge just advance the nodes by 100x their rate

====================  LOWER, OR NOT SURE IF THIS IS NEEDED  ==================

add capability to adjust component values while model is running
- structure have current and target fields, and steps
- keep count of how many active adjusts there are
- use exponential adjust to get there in N steps
- chnage dt while adjusting
- be nice to implement a switch for the LC circuit

ps1: #add wire       c4 c5   # XXX used to be c4 to c6 and got no warning

use of assert vs FATAL, could make my ASSERT

debug param to enable prints

maybe delete DCPWR_RAMP

====================  REJECTED IDEAS  =======================================

consider reversing the gridloc A3  ->  3A
  - algebraic chess is    a b c d e f g h
                        8      etc
  - theater seating is a 1 2 3 4 5 6 7 9
                       b
                       c

set params on the command line

should model worry about summing the current on the ground node and/or 
current return to the power supply

redesign control pane, maybe don't need delta_t, and could put controls on top

====================  INFO  =================================================

graphs
https://www.desmos.com/calculator

ltspice
https://electronics.stackexchange.com/questions/353826/how-to-make-an-ideal-diode-model-in-ltspice

exponential smoothing
https://en.wikipedia.org/wiki/Exponential_smoothing

rectifier
https://en.wikipedia.org/wiki/Rectifier

====================  DONE  =================================================

display the time in xxx.xxxxxxs
also display the stop_t
   RUNNING    123.456789s
   STOP_T     xxx.xxxxxxs
   RESET      CONT      STEP
model run xxxx.xxxx
model cont x.xxx  OR 1ms
    don't use plus, it is always a delta
val_to_str for secs does xxx.xxxxxxs

way to init inductor with current

reverse colors, so scren can be printed

draw double wide x/y axis
1G
aliasing problem, draw min and max

scope ...
- graph current
- more options on the set scope_a cmd
   - scope_a,b,c,d   current|voltage,ymin,ymax,gl,gl    (or gl,gnd    or gnd,gl   or just gl)

ac simple circuit
   power / capacitor
   verify current is 90 dgrees

delta_t ramp up
- finish coding this
- how many steps is it currently doing

clean up the test scripts

try a single test with 2 or 3 circurits,  LC, RC, RL
and with 3 graphs

try a full wave rectifier and filter power supply

should allow setting delta_t whne model is stopped ?

add diode

- check time params for > 0

scope trigger
- scope_mode param
    continuous
    trigger
- scope trigger param
    set scope_trigger 1 or 0
auto retrigger scope
trigger button for scope

automatically set delta_t when running the model
  if delta_t param is AUTO
    loop over all components
      count dc and ac power
      keep track of highest ac hz
    endloop
    freq = dcpower and notacpwr   ? 250
           notdcpower and acpwr   ?  maxacfreq
           dcpower and acpwr      ?  max(250,maxacfreq)
                                  :  error
     if freq == 0 error
     delta_t = xxxx
  else
    use fixed delta_t from the param
  endif

more diode circuits

TRY two caps in series

-- DONE
run,step,reset,cont cmds

str_to_val for time                               DONE
redo header line                                  DONE
make them smaller so they all fit                 DONE
display y units                                   DONE
val_to_str, remove trailing 0 and .               DONE
adjust position of title line                    DONE
set scope_a v,0,5mv,a1,a2,the title str           DONE
str_to_val for scope values                       DONE
click to hightlight graph and points/component    DONE
scope ...
- scope headings should be english - add title
- identify scope points on display
- hover or click to highlight the component, or the gridlocs

LC / inductor stablize
- update Inductor to use v_next, and retest inductor circuits, and LC circuit
- LC circuit

in model.c break model_thread up into 2 routines

advance model time after data is ready
- model reset  ->  model cont 1ms    advances time extra us

rgrid support
- be nice to see rgrid values update

make it a tripler

make voltage quadroupler

make the dots bigger

why is the small resistor needed

// XXX display power for all devices, and use the same equation as for resistor below;
//      - the display.c file can be used to not display for some of them
//       - try the LC circuit with power

// clear schematic should also clear scopes
//   and reset params back to default
//     perhaps can call this something else like reset_all, or clear_all 

display avg power used at power supply and a component

add support for more scopes

more graphs and scroll them up down

other component stuff to track
  - power
  - energy   NOT DOING ENERGY

Info used to fix readline pgm exit problem
    http://www.delorie.com/gnu/docs/readline/rlman_43.html
      
    Function: void rl_cleanup_after_signal (void)
    This function will reset the state of the terminal to what it was before readline() was called, and remove the Readline signal handlers for all signals, depending on the values of rl_catch_signals and rl_catch_sigwinch.

    Function: void rl_prep_terminal (int meta_flag)
    Modify the terminal settings for Readline's use, so readline() can read a single character at a time from the keyboard. The meta_flag argument should be non-zero if Readline should read eight-bit input.

    Function: void rl_deprep_terminal (void)
    Undo the effects of rl_prep_terminal(), leaving the terminal in the state in which it was before the most recent call to rl_prep_terminal().

    Function: void rl_tty_set_default_bindings (Keymap kmap)
    Read the operating system's terminal editing characters (as would be displayed by stty) to their Readline equivalents. The bindings are performed in kmap.

    Function: int rl_reset_terminal (const char *terminal_name)
    Reinitialize Readline's idea of the terminal settings using terminal_name as the terminal type (e.g., vt100). If terminal_name is NULL, the value of the TERM environment variable is used.

misc2 test shows no power supply power

regression test scripts in test dir
  run_diode_test
  run_resistor_tests
    ...
  run_all_tests
clean up all circuits

move file to unit_test dir and add README
- add the gen_resistor_grid pgms

program console needs to be reset when exitting form SDL app

delta_t 0 means auto detect
  - try 1 ms for DC circuits
  - 1/freq / 10000 for AC circuits;  choose smallest delta_t if multiple power
evaluate some of the tests with the above conditions

default DCRAMP to off

clean up all of the test scripts, again

resolve dcpwr_ramp and delta_t params
- when should dcpwr ramp be enabled or disabled
- try to minimize the amount of times these params are specified in a model file

What is best diode smoothing?
- Tests Not Working  (using .7)  
    d1, d2, ...
- Tests Not Working  (using .01)
    d10, d12   oscillations
    ps1        currents
    ps1x       fluctiations

model cont display button should allow model to continue after stop_t reached
- May already be fixed

LC circuit decay
- try smaller delta_t;  this helps with LC problem

display filename in SDL, use param 
