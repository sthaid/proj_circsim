====================  NEXT  =================================================

str_to_val for time                               DONE
redo header line                                  DONE
make them smaller so they all fit                 DONE
display y units                                   DONE
val_to_str, remove trailing 0 and .               DONE
adjust position of title line                    DONE
set scope_a v,0,5mv,a1,a2,the title str           DONE
str_to_val for scope values                       DONE
click to hightlight graph and points/component    IN PROGRESS

scope ...
- scope headings should be english - add title
- identify scope points on display
- validate scope params in main.c
- hover or click to highlight the component, or the gridlocs

LC / inductor stablize
- update Inductor to use v_next, and retest inductor circuits, and LC circuit
- LC circuit

in model.c break model_thread up into 2 routines

advance model time after data is ready
- model reset  ->  model cont 1ms    advances time extra us

----------

detect when model is stable

XXX issues in main and display

rgrid support
- instant dcon param
- display intermediate values param
- be nice to see rgrid values update

check for model stabilized, how to support the small currents such as in test rc7?

clean up all of the test scripts, again

--------------------------------------

add capability to adjust component values while model is running
- structure have current and target fields, and steps
- keep count of how many active adjusts there are
- use exponential adjust to get there in N steps
- chnage dt while adjusting

optimize model computations
  - and check with profiling
  - if there are performance issues use profiling;
  - optimization, and multi threads, change O0 to O2
  - factor common operations

test rc7 using only resistors should converge quickly
test rc7 converge with 1mf cap 
- perhaps change to 10M
- go back to unit test
IDEA - if model is slow to converge just advance the nodes by 100x their rate

====================  LOWER  ================================================

What is best diode smoothing?
- Tests Not Working  (using .7)  
    d1, d2, ...
- Tests Not Working  (using .01)
    d10, d12   oscillations
    ps1        currents
    ps1x       fluctiations

ps1: #add wire       c4 c5   # XXX used to be c4 to c6 and got no warning

update DOCUMENTATION

model cont display button should allow model to continue after stop_t reached
- May already be fixed

should model worry about summing the current on the ground node and/or 
current return to the power supply

verify model is stable

LC circuit decay
- try smaller delta_t;  this helps with LC problem

use of assert vs FATAL, could make my ASSERT

====================  FOR CONSIDERATION  ====================================

set params on the command line

other component stuff to track
  - power
  - energy

debug param to enable prints

init prior voltage on power up, delta_t==0
  this could be done first call to get_comp_power following model_reset

====================  TESTING  ==============================================

eval
d1 okay
d2 okay
d3 not tested
d4 ok
d5 ok
d6 ok
d7 ok
d8 ok
d9 ok
d10 ok
d11 ok
d12 okay
d13 okay

====================  INFO  =================================================

graphs
https://www.desmos.com/calculator

ltspice
https://electronics.stackexchange.com/questions/353826/how-to-make-an-ideal-diode-model-in-ltspice

exponential smoothing
https://en.wikipedia.org/wiki/Exponential_smoothing

rectivier
https://en.wikipedia.org/wiki/Rectifier

====================  WONT DO THIS  =========================================

consider reversing the gridloc A3  ->  3A
  - algebraic chess is    a b c d e f g h
                        8      etc
  - theater seating is a 1 2 3 4 5 6 7 9
                       b
                       c

====================  DONE  =================================================

display the time in xxx.xxxxxxs
also display the stop_t
   RUNNING    123.456789s
   STOP_T     xxx.xxxxxxs
   RESET      CONT      STEP
model run xxxx.xxxx
model cont x.xxx  OR 1ms
    don't use plus, it is always a delta
val_to_str for secs does xxx.xxxxxxs

way to init inductor with current

reverse colors, so scren can be printed

draw double wide x/y axis
1G
aliasing problem, draw min and max

scope ...
- graph current
- more options on the set scope_a cmd
   - scope_a,b,c,d   current|voltage,ymin,ymax,gl,gl    (or gl,gnd    or gnd,gl   or just gl)

ac simple circuit
   power / capacitor
   verify current is 90 dgrees

delta_t ramp up
- finish coding this
- how many steps is it currently doing

clean up the test scripts

try a single test with 2 or 3 circurits,  LC, RC, RL
and with 3 graphs

try a full wave rectifier and filter power supply

should allow setting delta_t whne model is stopped ?

add diode

- check time params for > 0

scope trigger
- scope_mode param
    continuous
    trigger
- scope trigger param
    set scope_trigger 1 or 0
auto retrigger scope
trigger button for scope

automatically set delta_t when running the model
  if delta_t param is AUTO
    loop over all components
      count dc and ac power
      keep track of highest ac hz
    endloop
    freq = dcpower and notacpwr   ? 250
           notdcpower and acpwr   ?  maxacfreq
           dcpower and acpwr      ?  max(250,maxacfreq)
                                  :  error
     if freq == 0 error
     delta_t = xxxx
  else
    use fixed delta_t from the param
  endif

more diode circuits

TRY two caps in series

-- DONE
run,step,reset,cont cmds
